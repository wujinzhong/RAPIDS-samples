from dask.distributed import Client, wait
from dask_cuda import LocalCUDACluster
import cudf, dask_cudf

# Use dask-cuda to start one worker per GPU on a single-node system
# When you shutdown this notebook kernel, the Dask cluster also shuts down.

#cluster = LocalCUDACluster(ip='0.0.0.0',n_workers=1, device_memory_limit='10000 MiB')
cluster = LocalCUDACluster(n_workers=3,
                           threads_per_worker=1,
                           processes=True,
                           device_memory_limit=None,
                           CUDA_VISIBLE_DEVICES='0,1,2')
client = Client(cluster)
# # print client info
print(client)

# Code to simulate_data

def generate_file(output_file,rows=100):
    with open(output_file, 'wb') as f:
        f.write(b'A,B,C,D,E,F,G,H,I,J,K\n')
        f.write(b'22,697,56,0.0,0.0,0.0,0.0,0.0,0.0,0,0\n23,697,56,0.0,0.0,0.0,0.0,0.0,0.0,0,0\n'*(rows//2))
        f.close()

# generate the test file
generate_file('test_4_000_000.csv',rows=4_000_000)
generate_file('test_1_000_000_000.csv',rows=1_000_000_000)

def initialize_rmm():
    import rmm
    from rmm import rmm_config as rmm_cfg
    import cudf
    rmm.finalize()
    rmm_cfg.use_managed_memorclient.run(initialize_rmm)y = True
    rmm.initialize()
    print(rmm_cfg.use_managed_memory)
client.run(initialize_rmm)

# reading it using dask_cudf
df0 = dask_cudf.read_csv('test_4_000_000.csv',      chunksize='1 MiB').persist()
print(df0.head(10).to_pandas())
for column in df0.columns:
    print(df0[column].dtype)

df1 = dask_cudf.read_csv('test_4_000_000.csv',      chunksize='1 MiB').persist()
df2 = dask_cudf.read_csv('test_4_000_000.csv',      chunksize='1 MiB').persist()
df3 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()

df20 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df21 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df22 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df23 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df24 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df25 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df26 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df27 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df28 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df29 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()

df30 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df31 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df32 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df33 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df34 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df35 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df36 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df37 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df38 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df39 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()

df40 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df41 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df42 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df43 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df44 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df45 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df46 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df47 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df48 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df49 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()

df50 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df51 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df52 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df53 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df54 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df55 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df56 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df57 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df58 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df59 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()

df60 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df61 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df62 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df63 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df64 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df65 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df66 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df67 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df68 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df69 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()

df70 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df71 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df72 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df73 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df74 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df75 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df76 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df77 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df78 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()
df79 = dask_cudf.read_csv('test_100_000_000.csv',  chunksize='1 MiB').persist()

df80 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df81 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df82 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df83 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df84 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df85 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df86 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df87 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df88 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()
df89 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='10 MiB').persist()

df90 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df91 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df92 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df93 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df94 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df95 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df96 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df97 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df98 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df99 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df100 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df101 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df102 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df103 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df104 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df105 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df106 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df107 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df108 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df109 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df110 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df111 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df112 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df113 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df114 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df115 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df116 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df117 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df118 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df119 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df120 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df121 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df122 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df123 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df124 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df125 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df126 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df127 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df128 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df129 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df130 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df131 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df132 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df133 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df134 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df135 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df136 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df137 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df138 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df139 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df140 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df141 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df142 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df143 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df144 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df145 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df146 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df147 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df148 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df149 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df150 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df151 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df152 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df153 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df154 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df155 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df156 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df157 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df158 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df159 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df160 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df161 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df162 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df163 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df164 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df165 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df166 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df167 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df168 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df169 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df170 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df171 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df172 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df173 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df174 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df175 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df176 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df177 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df178 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df179 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df180 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df181 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df182 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df183 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df184 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df185 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df186 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df187 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df188 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df189 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df190 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df191 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df192 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df193 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df194 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df195 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df196 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df197 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df198 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df199 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df200 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df201 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df202 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df203 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df204 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df205 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df206 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df207 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df208 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df209 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df210 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df211 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df212 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df213 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df214 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df215 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df216 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df217 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df218 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df219 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df220 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df221 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df222 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df223 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df224 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df225 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df226 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df227 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df228 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df229 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df230 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df231 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df232 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df233 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df234 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df235 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df236 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df237 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df238 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df239 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df240 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df241 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df242 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df243 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df244 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df245 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df246 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df247 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df248 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df249 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df250 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df251 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df252 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df253 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df254 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df255 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df256 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df257 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df258 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df259 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df260 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df261 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df262 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df263 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df264 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df265 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df266 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df267 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df268 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df269 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df270 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df271 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df272 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df273 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df274 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df275 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df276 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df277 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df278 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df279 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df280 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df281 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df282 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df283 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df284 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df285 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df286 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df287 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df288 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df289 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()

df290 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df291 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df292 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df293 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df294 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df295 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df296 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df297 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df298 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
df299 = dask_cudf.read_csv('test_1_000_000_000.csv',  chunksize='100 MiB').persist()
# reading it using dask_cudf
#df2 = df.sort_values(['A','B','C']).persist()

client.close()